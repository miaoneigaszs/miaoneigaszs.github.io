<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="page__footer-follow">
  <ul class="social-icons">
    {% if site.data.ui-text[site.locale].follow_label %}
      <li><strong>{{ site.data.ui-text[site.locale].follow_label }}</strong></li>
    {% endif %}
    {% if site.footer.links %}
      {% for link in site.footer.links %}
        {% if link.label and link.url %}
          <li><a href="{{ link.url }}" rel="nofollow noopener noreferrer"><i class="{{ link.icon | default: 'fas fa-link' }}" aria-hidden="true"></i> {{ link.label }}</a></li>
        {% endif %}
      {% endfor %}
    {% endif %}
    <li><a href="{{ '/feed.xml' | relative_url }}"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> {{ site.data.ui-text[site.locale].feed_label | default: "Feed" }}</a></li>
  </ul>
</div>
<div class="page__footer-copyright">
  &copy; {{ site.time | date: '%Y' }} {{ site.name | default: site.title }}. Designed by <a href="https://github.com/miaoneigaszs">Cln_Nagisa</a>.
  <br>
  <span style="font-size: 0.8em; color: #888;">
    <span id="busuanzi_container_site_pv" style="display:none; color: #ffffff; opacity: 0.8;">
      <i class="fas fa-eye"></i> 本站总访问量: <span id="busuanzi_value_site_pv"></span> 次
    </span>
    &nbsp;|&nbsp;
    <span id="busuanzi_container_site_uv" style="display:none; color: #ffffff; opacity: 0.8;">
      <i class="fas fa-user"></i> 访客数: <span id="busuanzi_value_site_uv"></span> 人
    </span>
  </span>
</div>

<style>
    /* 画布样式 */
    #live2d {
        position: fixed;
        bottom: 0;
        left: 0;
        z-index: 999;
        /* 关键：设置缩放基点为左下角，这样放大时也是向右上延伸 */
        transform-origin: bottom left; 
        transition: transform 0.2s ease; /* 让缩放有动画过渡，更丝滑 */
    }

    /* 控制按钮容器 */
    #live2d-controls {
        position: fixed;
        bottom: 270px; /* 放在模型头顶 (画布高260 + 10间距) */
        left: 10px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        gap: 5px;
        opacity: 0; /* 默认隐藏 */
        transition: opacity 0.3s;
    }

    /* 鼠标移过去才显示按钮，保持界面清爽 */
    #live2d-wrapper:hover #live2d-controls {
        opacity: 1;
    }

    /* 按钮样式 */
    .l2d-btn {
        width: 30px;
        height: 30px;
        border: none;
        border-radius: 50%;
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        font-size: 18px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        outline: none;
    }
    .l2d-btn:hover {
        background-color: #d2691e; /* 悬停变色 */
    }

    /* 移动端隐藏 */
    @media (max-width: 768px) {
        #live2d, #live2d-controls { display: none; }
    }
</style>

<div id="live2d-wrapper">
    <div id="live2d-controls">
        <button class="l2d-btn" onclick="changeScale(0.1)" title="放大">+</button>
        <button class="l2d-btn" onclick="changeScale(-0.1)" title="缩小">-</button>
        <button class="l2d-btn" onclick="resetScale()" title="重置" style="font-size: 12px;">↺</button>
    </div>
    
    <canvas id="live2d" width="280" height="260"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/gh/imuncle/live2d/js/live2d.js"></script>

<script type="text/javascript">
    // --- 缩放逻辑 ---
    var currentScale = 1.0;

    function changeScale(delta) {
        currentScale += delta;
        // 限制最小 0.5 倍，最大 2.0 倍
        if (currentScale < 0.5) currentScale = 0.5;
        if (currentScale > 2.0) currentScale = 2.0;
        
        applyScale();
    }

    function resetScale() {
        currentScale = 1.0;
        applyScale();
    }

    function applyScale() {
        var canvas = document.getElementById("live2d");
        canvas.style.transform = "scale(" + currentScale + ")";
    }

    // --- 加载模型逻辑 ---
    console.log("正在加载 Live2D...");
    setTimeout(() => {
        try {
            // 这里记得确认路径正确
            loadlive2d("live2d", "{{ '/assets/live2d/Violet/index.json' | relative_url }}");
            console.log("Live2D 加载指令已发送");
        } catch(err) {
            console.error("Live2D 加载失败:", err);
        }
    }, 1000);
</script>